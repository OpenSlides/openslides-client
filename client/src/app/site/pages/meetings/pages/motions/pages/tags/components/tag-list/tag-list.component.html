<os-head-bar
    [goBack]="true"
    [hasMainButton]="true"
    [mainActionTooltip]="'New tag' | translate"
    [nav]="false"
    [multiSelectMode]="isMultiSelect"
    (mainEvent)="openTagDialog()"
>
    <div class="title-slot">
        <h2>{{ 'Tags' | translate }}</h2>
    </div>
</os-head-bar>

<os-list
    [listObservableProvider]="repo"
    [hiddenInMobile]="['menu']"
    [filterProps]="['name']"
    [addBottomSpacer]="hasInteractionState | async"
    [(selectedRows)]="selectedRows"
>
    <!-- Name column -->
    <div *osScrollingTableCell="'name'; value as name" class="cell-slot fill">
        <div>
            {{ name }}
        </div>
    </div>
    <!-- edit column -->
    <div *osScrollingTableCell="'edit'; row as tag; config: { width: 45 }" class="cell-slot fill">
        <button mat-icon-button (click)="openTagDialog(tag)">
            <mat-icon>edit</mat-icon>
        </button>
    </div>
    <!-- delete column -->
    <div *osScrollingTableCell="'delete'; row as tag; config: { width: 45 }" class="cell-slot fill">
        <button mat-icon-button color="warn" (click)="onDeleteButton(tag)">
            <mat-icon>delete</mat-icon>
        </button>
    </div>
</os-list>

<!-- Template for dialog for quick editing -->
<ng-template #tagDialog>
    <h1 mat-dialog-title>
        @if (currentTag) {
            <span>{{ 'Edit tag' | translate }}</span>
        }
        @if (!currentTag) {
            <span>{{ 'New tag' | translate }}</span>
        }
    </h1>
    <mat-dialog-content class="os-form-card-mobile">
        <form tabindex="-1" [formGroup]="tagForm" (keydown)="onKeyDown($event)">
            <mat-form-field>
                <mat-label>{{ 'Name' | translate }}</mat-label>
                <input required type="text" matInput formControlName="name" />
            </mat-form-field>
        </form>
    </mat-dialog-content>

    <mat-dialog-actions>
        <button type="submit" mat-button color="accent" [mat-dialog-close]="true">
            <span>{{ 'Save' | translate }}</span>
        </button>
        <button type="button" mat-button [mat-dialog-close]="false">
            <span>{{ 'Cancel' | translate }}</span>
        </button>
    </mat-dialog-actions>
</ng-template>
